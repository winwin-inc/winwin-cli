---
name: code-review
description: ä»£ç å®¡æŸ¥åŠ©æ‰‹ - å…¨é¢æ£€æŸ¥ä»£ç è´¨é‡ã€å®‰å…¨æ€§ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§
version: 1.0.0
author: winwin-cli
---

# ä»£ç å®¡æŸ¥åŠ©æ‰‹

å…¨é¢çš„ä»£ç å®¡æŸ¥æŠ€èƒ½ï¼Œå¸®åŠ©ä½ è¯†åˆ«æ½œåœ¨é—®é¢˜ã€æ”¹è¿›ä»£ç è´¨é‡å¹¶éµå¾ªæœ€ä½³å®è·µã€‚

## å®¡æŸ¥ç»´åº¦

### 1. ä»£ç è´¨é‡

**å¯è¯»æ€§**ï¼š
- å˜é‡å’Œå‡½æ•°å‘½åæ¸…æ™°
- ä»£ç é€»è¾‘æ˜“äºç†è§£
- é¿å…è¿‡åº¦åµŒå¥—
- é€‚å½“çš„ä»£ç æ³¨é‡Š

**å¯ç»´æŠ¤æ€§**ï¼š
- éµå¾ª DRY åŸåˆ™ï¼ˆDon't Repeat Yourselfï¼‰
- å‡½æ•°å•ä¸€èŒè´£
- æ¨¡å—åŒ–è®¾è®¡
- ç‰ˆæœ¬æ§åˆ¶å‹å¥½

**æµ‹è¯•è¦†ç›–**ï¼š
- å•å…ƒæµ‹è¯•å……åˆ†
- è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- é”™è¯¯å¤„ç†æµ‹è¯•
- æ€§èƒ½æµ‹è¯•ï¼ˆå¦‚éœ€è¦ï¼‰

### 2. å®‰å…¨æ€§æ£€æŸ¥

**å¸¸è§æ¼æ´**ï¼š
- SQL æ³¨å…¥
- XSSï¼ˆè·¨ç«™è„šæœ¬æ”»å‡»ï¼‰
- CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰
- ä¸å®‰å…¨çš„ååºåˆ—åŒ–
- ç¡¬ç¼–ç æ•æ„Ÿä¿¡æ¯
- ä¸å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆ

**å®‰å…¨æœ€ä½³å®è·µ**ï¼š
- è¾“å…¥éªŒè¯å’Œæ¸…ç†
- æœ€å°æƒé™åŸåˆ™
- å®‰å…¨çš„å¯†ç å­˜å‚¨
- HTTPS ä½¿ç”¨
- å®‰å…¨å¤´éƒ¨é…ç½®

### 3. æ€§èƒ½ä¼˜åŒ–

**ç®—æ³•å¤æ‚åº¦**ï¼š
- æ—¶é—´å¤æ‚åº¦åˆ†æ
- ç©ºé—´å¤æ‚åº¦è€ƒè™‘
- æ•°æ®ç»“æ„é€‰æ‹©
- ç¼“å­˜ç­–ç•¥

**èµ„æºç®¡ç†**ï¼š
- å†…å­˜æ³„æ¼æ£€æŸ¥
- è¿æ¥æ± ä½¿ç”¨
- èµ„æºæ­£ç¡®é‡Šæ”¾
- å¹¶å‘å¤„ç†

### 4. é”™è¯¯å¤„ç†

**å¼‚å¸¸å¤„ç†**ï¼š
- é€‚å½“çš„å¼‚å¸¸æ•è·
- æœ‰æ„ä¹‰çš„é”™è¯¯æ¶ˆæ¯
- æ—¥å¿—è®°å½•
- é™çº§ç­–ç•¥

**è¾¹ç•Œæ¡ä»¶**ï¼š
- ç©ºå€¼æ£€æŸ¥
- æç«¯å€¼å¤„ç†
- å¹¶å‘å†²çª
- èµ„æºé™åˆ¶

## å®¡æŸ¥æµç¨‹

### é˜¶æ®µ 1: å¿«é€Ÿæ‰«æ

1. **ç»“æ„æ¦‚è§ˆ**ï¼šç†è§£ä»£ç æ•´ä½“æ¶æ„
2. **æ˜æ˜¾é—®é¢˜**ï¼šè¯†åˆ«æ˜¾è€Œæ˜“è§çš„é”™è¯¯
3. **å®‰å…¨çº¢çº¿**ï¼šæ£€æŸ¥ä¸¥é‡å®‰å…¨é—®é¢˜

### é˜¶æ®µ 2: æ·±å…¥åˆ†æ

1. **é€»è¾‘å®¡æŸ¥**ï¼šéªŒè¯ä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§
2. **æ€§èƒ½è¯„ä¼°**ï¼šåˆ†ææ€§èƒ½ç“¶é¢ˆ
3. **æµ‹è¯•éªŒè¯**ï¼šç¡®è®¤æµ‹è¯•è¦†ç›–åº¦

### é˜¶æ®µ 3: å»ºè®®æ”¹è¿›

1. **ä¼˜å…ˆçº§æ’åº**ï¼šæ ‡è®°é—®é¢˜ä¸¥é‡ç¨‹åº¦
2. **å…·ä½“å»ºè®®**ï¼šæä¾›æ”¹è¿›æ–¹æ¡ˆ
3. **ç¤ºä¾‹ä»£ç **ï¼šå±•ç¤ºæœ€ä½³å®è·µ

## é—®é¢˜åˆ†çº§

**ğŸ”´ ä¸¥é‡ï¼ˆCriticalï¼‰**ï¼š
- å®‰å…¨æ¼æ´
- æ•°æ®ä¸¢å¤±é£é™©
- ç³»ç»Ÿå´©æºƒé—®é¢˜
- å¿…é¡»ä¿®å¤

**ğŸŸ  é‡è¦ï¼ˆMajorï¼‰**ï¼š
- æ€§èƒ½é—®é¢˜
- é€»è¾‘é”™è¯¯
- å¯ç»´æŠ¤æ€§é—®é¢˜
- åº”è¯¥ä¿®å¤

**ğŸŸ¡ æ¬¡è¦ï¼ˆMinorï¼‰**ï¼š
- ä»£ç é£æ ¼
- å‘½åå»ºè®®
- å°å¹…ä¼˜åŒ–
- å»ºè®®æ”¹è¿›

**ğŸ”¢ æç¤ºï¼ˆInfoï¼‰**ï¼š
- æœ€ä½³å®è·µæç¤º
- æ–‡æ¡£å»ºè®®
- å­¦ä¹ èµ„æº
- å¯é€‰æ”¹è¿›

## å®¡æŸ¥æŠ¥å‘Šæ¨¡æ¿

```markdown
# ä»£ç å®¡æŸ¥æŠ¥å‘Š

**é¡¹ç›®**: [é¡¹ç›®åç§°]
**æ–‡ä»¶**: [æ–‡ä»¶åˆ—è¡¨]
**å®¡æŸ¥äºº**: AI åŠ©æ‰‹
**æ—¥æœŸ**: [æ—¥æœŸ]

## æ€»ä½“è¯„ä¼°

- ä»£ç è´¨é‡: â­â­â­â­â˜† (4/5)
- å®‰å…¨æ€§: â­â­â­â˜†â˜† (3/5)
- æ€§èƒ½: â­â­â­â­â˜† (4/5)
- å¯ç»´æŠ¤æ€§: â­â­â­â­â­ (5/5)

## å‘ç°çš„é—®é¢˜

### ğŸ”´ ä¸¥é‡é—®é¢˜ (å¿…é¡»ä¿®å¤)

1. [å®‰å…¨æ¼æ´æè¿°]
   - **ä½ç½®**: `file.py:123`
   - **é—®é¢˜**: SQLæ³¨å…¥æ¼æ´
   - **ä¿®å¤**:
     ```python
     # ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
     cursor.execute("SELECT * FROM users WHERE id = %s", (user_id,))
     ```

### ğŸŸ  é‡è¦é—®é¢˜ (åº”è¯¥ä¿®å¤)

2. [æ€§èƒ½é—®é¢˜æè¿°]
   - **ä½ç½®**: `file.py:456`
   - **é—®é¢˜**: O(nÂ²) å¤æ‚åº¦å¯ä¼˜åŒ–ä¸º O(n)
   - **å»ºè®®**: ä½¿ç”¨å“ˆå¸Œè¡¨ä¼˜åŒ–æŸ¥æ‰¾

## äº®ç‚¹

âœ¨ è‰¯å¥½çš„é”™è¯¯å¤„ç†
âœ¨ å®Œå–„çš„ç±»å‹æ³¨è§£
âœ¨ æ¸…æ™°çš„ä»£ç ç»“æ„

## å»ºè®®æ”¹è¿›

1. æ·»åŠ å•å…ƒæµ‹è¯•è¦†ç›–è¾¹ç•Œæƒ…å†µ
2. è€ƒè™‘ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“æŸ¥è¯¢
3. è¡¥å…… API æ–‡æ¡£

## æ€»ç»“

ä»£ç æ•´ä½“è´¨é‡è‰¯å¥½ï¼Œä¸»è¦å…³æ³¨å®‰å…¨æ¼æ´ä¿®å¤å’Œæ€§èƒ½ä¼˜åŒ–ã€‚å»ºè®®ä¿®å¤ä¸¥é‡é—®é¢˜åå†åˆå¹¶ã€‚
```

## ä½¿ç”¨ç¤ºä¾‹

**ç”¨æˆ·**ï¼šå¸®æˆ‘å®¡æŸ¥è¿™æ®µä»£ç 

```python
def get_user(username):
    query = f"SELECT * FROM users WHERE username = '{username}'"
    return db.execute(query)
```

**åŠ©æ‰‹**ï¼šğŸ”´ å‘ç°ä¸¥é‡å®‰å…¨é—®é¢˜ï¼

**SQL æ³¨å…¥æ¼æ´**ï¼š
- å½“å‰ä»£ç ç›´æ¥æ‹¼æ¥ç”¨æˆ·è¾“å…¥ï¼Œå­˜åœ¨ SQL æ³¨å…¥é£é™©
- æ”»å‡»è€…å¯ä»¥é€šè¿‡ `username` å‚æ•°æ³¨å…¥æ¶æ„ SQL

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
```python
def get_user(username):
    query = "SELECT * FROM users WHERE username = %s"
    return db.execute(query, (username,))
```

**å…¶ä»–å»ºè®®**ï¼š
- ğŸŸ  æ·»åŠ ç”¨æˆ·åé•¿åº¦éªŒè¯
- ğŸŸ  æ·»åŠ å¼‚å¸¸å¤„ç†
- ğŸŸ¡ è€ƒè™‘è¿”å›ç”¨æˆ·å¯¹è±¡è€ŒéåŸå§‹æŸ¥è¯¢ç»“æœ

## é›†æˆæ£€æŸ¥æ¸…å•

å®¡æŸ¥æ—¶è‡ªåŠ¨æ£€æŸ¥ï¼š
- [ ] å¯¼å…¥è¯­å¥ä¼˜åŒ–ï¼ˆæœªä½¿ç”¨çš„å¯¼å…¥ï¼‰
- [ ] ä»£ç é‡å¤æ£€æµ‹
- [ ] å¤æ‚åº¦åˆ†æï¼ˆåœˆå¤æ‚åº¦ > 10 è­¦å‘Šï¼‰
- [ ] ç±»å‹æ³¨è§£å®Œæ•´æ€§
- [ ] æ–‡æ¡£å­—ç¬¦ä¸²è¦†ç›–ç‡
- [ ] æµ‹è¯•è¦†ç›–ç‡æ£€æŸ¥
- [ ] ä¾èµ–ç‰ˆæœ¬æ£€æŸ¥
- [ ] ä»£ç æ ¼å¼åŒ–ï¼ˆblack/ruffï¼‰

## é…ç½®

é¡¹ç›®æ ¹ç›®å½•å¯åˆ›å»º `.code-review.yaml`ï¼š

```yaml
# å®¡æŸ¥çº§åˆ«
severity_level: major  # critical | major | minor | info

# å¿½ç•¥è§„åˆ™
ignore:
  - "test/*.py"  # æµ‹è¯•æ–‡ä»¶è·³è¿‡æŸäº›æ£€æŸ¥
  - "migrations/*.py"

# è‡ªå®šä¹‰è§„åˆ™
custom_rules:
  - name: no-logging-in-hot-path
    pattern: "logger\\.(info|debug)"
    exclude_paths: ["*/startup.py"]

# é›†æˆå·¥å…·
tools:
  pylint: true
  mypy: true
  bandit: true  # å®‰å…¨æ£€æŸ¥
```
